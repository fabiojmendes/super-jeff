language: rust
os:
- linux
- windows
rust:
- stable
jobs:
  allow_failures:
  - rust: nightly
  fast_finish: true
before_install:
- if [ "$TRAVIS_OS_NAME" = "windows" ]; then export LIB="./lib"; fi
install:
- cargo build --release
script:
- cargo test --release
addons:
  apt:
    packages:
    - libsdl2-dev
    - libsdl2-image-dev
    - libsdl2-mixer-dev
    - libsdl2-ttf-dev
before_deploy:
- |-
  if [ "$TRAVIS_OS_NAME" = "windows" ]; then
    mkdir super-jeff
    cp target/release/super-jeff.exe ./super-jeff
    cp -r assets ./super-jeff
    cp lib/*.{dll,txt} ./super-jeff
    ls -l super-jeff
    tar -cavf super-jeff.zip super-jeff
  fi
  if [ "$TRAVIS_OS_NAME" = "linux" ]; then
    zip -j super-jeff.zip target/release/super-jeff
    zip -r super-jeff.zip assets
  fi
deploy:
  provider: releases
  file: super-jeff.zip
  draft: true
  token:
    secure: RH8q5h21ATfF1OsFuz8gM/uDQ5pEXfUV6xYaoAL+uM8KoJQEziMwb72q3/n5GKMIL2u3Aq2S/sQgJrKnSQnYzCDTpyZcVMUwBWleBKtyVB+ZBqqNbPqX4xBqvaZVUicSyOOzIeZLw0jvrvKduh87DEZa3CZpi4OmCapmb7dz6TLFiNBYTREXPrk6fOzR9Y2wmeWw3UXJb1nw/OHsQHBjMzQ7NeEIttwDPIbZn+NmYEDs4BJxBmEKeads2eLKwRtpflPN1Kq0v/Cw7ytX3jKPPrYb+RTo2hPYCKznYxyUNFgL7r4b2FPNWSJfgL3UNfkn9AsmhxrtgSYAuv+Oc0XVsdzVknjZXwAk1zc9sO6DLR7X0nmj3obSUbvEiR7Ua9mxFvjMFE5xgNdTRWfvdZLBO5N1xSNqOfWqoQ5C+L15IT65tuSYIxa2BvmC9297ubB7DV0ck/0J3KFoOMOeLozrwFUi3oQ9UD1Oflz9Vz/h96t47ZrzK4GHbrJo5/pBuWkZrN4bwMDZA8qukcnL9j4Qq543i8aCgWcqli1PPAYCKNk1fbgN4g+FMBdEOEauXYBNmYZiR30+Pignrwpo2KinwPFSYkoTSimVCaFzD8gCFi+RJXU/cN3ex6clX6aL4TJOfgwwyqBJ3sVn0CCV+zMyymcTtCK2cVYds88JvtM2Bao=
