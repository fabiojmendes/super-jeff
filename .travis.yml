language: rust
os:
- linux
- windows
rust:
- stable
jobs:
  allow_failures:
  - rust: nightly
  fast_finish: true
before_install:
- if [ "$TRAVIS_OS_NAME" = "windows" ]; then export LIB="./lib"; fi
install:
- cargo build --release
script:
- cargo test --release
addons:
  apt:
    packages:
    - libsdl2-dev
    - libsdl2-image-dev
    - libsdl2-mixer-dev
    - libsdl2-ttf-dev
before_deploy:
- |-
  if [ "$TRAVIS_OS_NAME" = "windows" ]; then
    mkdir super-jeff
    cp target/release/super-jeff.exe ./super-jeff
    cp -r assets ./super-jeff
    cp lib/*.{dll,txt} ./super-jeff
    ls -l super-jeff
    tar -cavf super-jeff.zip super-jeff
  fi
  if [ "$TRAVIS_OS_NAME" = "linux" ]; then
    zip -j super-jeff.zip target/release/super-jeff
    zip -r super-jeff.zip assets
  fi
deploy:
  provider: releases
  draft: true
  file: super-jeff.zip
  user: fabiojmendes
  password:
    secure: bysBuM76246lM3QvZJuU/lJNkP4kwRGo1lYTSpSTaNWJmd3JZgbvkEaPWPZlrc4Pjj45IYTksqGw/FCfIXZ4fBT6JyB7pvS76WzpY065bs7omwVSMZkXDuGFf10W9N6vFeatp4W+X5X1jFNsL26kP1kv4hOtSGGgSJosyWn8JPOz5+YPIRYEsjO8oX/Gbbw4NYWmycPwVBDG376kt7IaGghj2VYMIQPey/FT8QRIeMRGUUNp7gWlPHbr/9p03vWHEuZjsChTT3QNQaqGbh18Ej2wEedxplzy3qeDqm/3w2rMbZNh4q22AeMzX3B3lnU6Tt8I421avGqyLOJ8P1ki/qYsYL4/sSbWKBsbhppX1z4MBGued8jwVRsPkrjmSpJPDVDukL4vKXfBTAtd6ai8AuApq8dyLJ6bAZt6IGhn+hQgZkuccYTMG2ejYoc0Xw9xeZ3MVpjkwRt2EAbkGeMWEF/O9ml27HdG7+dwY4lX0/FhcPbNEzVb+aiwmu8+wqF+n00j1CUT4FQJ+Rn4xKiPt2T3GhMuW8AqGKf3W5BlFrfZ9hkcs1ifF252vHyS+01nTUsrhcWJ1nwJJBTeuSw9umDdpjofKR95NKyL3UIa6HxGSYDlFURvL6vLjpeUay4mzAJgDH+/Noq8TSrXCIBJv1hMzIiQPs4/AZqrR3aiHkg=
