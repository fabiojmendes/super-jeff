language: rust
os:
- linux
- windows
rust:
- stable
jobs:
  allow_failures:
  - rust: nightly
  fast_finish: true
before_install:
- if [ "$TRAVIS_OS_NAME" = "windows" ]; then export LIB="./lib"; fi
install:
- cargo build --release
script:
- cargo test --release
addons:
  apt:
    packages:
    - libsdl2-dev
    - libsdl2-image-dev
    - libsdl2-mixer-dev
    - libsdl2-ttf-dev
before_deploy:
- |-
  if [ "$TRAVIS_OS_NAME" = "windows" ]; then
    mkdir super-jeff
    cp target/release/super-jeff.exe ./super-jeff
    cp -r assets ./super-jeff
    cp lib/*.{dll,txt} ./super-jeff
    ls -l super-jeff
    tar -cavf super-jeff.zip super-jeff
  fi
  if [ "$TRAVIS_OS_NAME" = "linux" ]; then
    zip -j super-jeff.zip target/release/super-jeff
    zip -r super-jeff.zip assets
  fi
deploy:
  provider: script
  script: bash deploy.sh
  skip_cleanup: true
  draft: true
  api_key:
    secure: 5uZbHZr/T78yrlJnNLnEkU+KFfwK/hIkv1c+t06Fl8trLfni8ghgfwUSOcHJMQyKMnDG/mCZR9MqhX9ghnpBIi6luZyH8AAswZuDVdsXh7UuLTd8Q11orU1S51H8eZHrtPsbYd3pwAHglcejGsLdYPIJIzxHotyj2LcaZnyRsZWCsZJYyf+KLy0GYxmzD4EA3cQeAbNCnaBc9BWYL/boI8H7NB0+7w8vjGs5uKNP3SkljjuH/qS3QsyLXuDK2+8EZQfMCxW6N98fp1i42WeYG9VwdJVMt43GsHD6psi5wfklYcvChnMPAMilTDWhV5aXRLdtwsBCu9Fb0NbSpCWxgJ+ikIOwAQp/4mlSEob5XCJZFr6Fb3y5u0cUQKksBMLPnX5nPoTJEQyYRua8tt+ZFlmBDCOiFhFnM2JTTQr3Usiuwa3a6cldGeIqjYvVnSslGAIBkI4pC4vYnm1L9MfVcNmipf0zL16ioI9vBhdUXmctGkdSoSAIQVwSq0hMbwfFdVuaBryADzt51fvS1UcoyKNWOIKhY3YnfZS0EALG1kgQGTAbxAcEZo/knrNmXre1rjYUj2g/ZOX85QqWpu6JCk9qPJLQOPKLbzAT1zMl9lDAbzm4NLYj4+FuzHpkpvyECos2ayFEOnKGshHnvupqU6qt5WmkXk2VAsjAN6HvfLE=
